import{g as w,i as y,h as I,k as b,l as C,$ as O,m as g,o as P,t as p,v as _,y as S,q as Q,a0 as N,X as J,N as h,Y as z,L as d,I as k,J as q,Q as G,a1 as K,U as Z,K as V,Z as X,_ as $,a2 as ee,z as ne,a3 as te,H as oe,a4 as x,a5 as ie}from"./vendor-1f431ae3.js";const re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAwCAYAAACFUvPfAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAALaADAAQAAAABAAAAMAAAAADe2FZjAAAEF0lEQVRoBe2WzWskRRiHf13V092TxI2oEzYeVDwITtyDuCiihwiCePGgxIM3vYgHL4J4UIhBRA8i/gPqyUvWg7AiIuIeloDiYUHJLOK6BPwIk9nNODM9Xf1RVe1b3elJRjCZmQ6euqGmuqer33rq4e23GqiOykBloDJQGagMVAYqA5WBykBlYFYD1qwP/tdzaZqOx9zYOLxeX0+L5yzLGp0X/03a25MOnGRcBtx+6Rlo9SL08G4EooFnxa8Yiivox5/h5Ys/4cl7NVorNDRnngX+0MIkVMeMSf23zyKML8J7/Dy8hwF2Buh9CnS+AEQIdLspBuGb+M7/qLW4qJrNpsLapjYhpwVnx3BMfCtNNx3Etc9xywvnMf80wG8HmQainw0RxSGrnmeBp+8k5/j9S0HbvXb5io0Lz880/0wPHV1NlhLd316He+4xOCv5ragF7L9PrH1qBJyB0626x/lC+qrSvH5r/W+n1WpxUM5nMY4GPeH8lHJaPgfeAFQHCL+ntkXT+vnUc3W6pvTIwC0wy3rA4dwLmK2avZ7Eo9uKBuYJfgJscbs8dLCxDMt+EOEPBEZNEWyBYHqTz6bPXrzUnNrSShxHIsYiOL69zrCGLLcLqJP68tB+9w5wj+YhWDafQ2s61wNqxjZhmrQ2pvMFCEvXuCUZ7wqH794ZWs28LJqlTXSUyuksF2M/yOwqgkx2c1ADa4wLAQRk2sAGQQakhN6yFC2hltfz5kSY44NKQeeh+vtI/SSzWhg2CzCgmWISmKUGmaYFBDfCSymnfxJ6/+ospVcWOLLp5DGP/y0P/Rp66O99DQNq7Po3Ds0a0wY+My2QSv2N2mO/OyxR2o6UQk+Lv7yJ06JYSnnolZVU9cUn2O9SmaMWGFBqYXRwbqAJWIi94TX5biotpcGl1DXZ6LnqIbNDTnmUgi52Mv5l5ysMxIcZcGjy2DTK4ZHlcBC14zeSge4qphICjj3bS0A7o9nSp2TOkm7aZ8bGZy/jxhO87V91G0+dfY/Z7BWIIK9KYUi5qy/Hf8YfBG3sqJTHiQWhmTVkbip+wX3x6volVSx+LPAxF+VLXhZ8VQ+iP2Rta/iWe5v42Fngj0BbdnRTXh12ZIcKhTaGbcYjybRwXBU1lu9KlndXp04NM52poKWO0RZsviNaP9a6grkO972+st05pXhE5c1hTEluJy7XUejGUQNLMbAmTdWY1rKBLW3aTJqBZ7nZkb36DhYCreeYHbMUXHvaYi5XDK70EcgulmRjm77wNtenzuXCbmnTRaAx493rbGf3Jr/njMzj920CnKdUaFCjlDioy7NYNvOdGrQJNgI32/L2tkXfFPlxgToqjWVhD6KdLnQRdARf/HHQz2r2X2Gqy8pAZaAyUBmoDFQGKgP/q4F/AJYg9/s0ZoABAAAAAElFTkSuQmCC";function le(n,e={}){let o="";const{needZ:t,needA:i}=e;return(t?n.slice().concat(n[0]):n.slice()).forEach((a,l)=>{const{x:s,y:f}=e.format?e.format(a):a,A=s+","+f;return l===0?(o+="M"+A,o):i?.[l]?(o+="A"+i[l]+","+A,o):(o+="L"+A,o)}),o+(t?"Z":"")}function se({x:n,y:e},o,t){const{max:i,min:r}=t;return{x:(n-r.x)*o,y:(i.y-e)*o}}function ae(n,e){const o=n.x*1e3+e.bounding.origin.x,t=-n.z*1e3+e.bounding.origin.y;return{x:o,y:t}}function fe(n,e){const o=e.bounding,t=o.max.x-o.min.x,i=o.max.y-o.min.y;return{x:(n.x-o.min.x)/t,y:(o.max.y-n.y)/i}}function ce(n,e){return Math.max(...e.work.observers.map(t=>n.z>=t.standingPosition.z?t.floorIndex:0))}async function ue(n){const e=new Headers({"Content-Type":"text/plain"}),o=async function(i){const r={index:i.index,url:i.url,svgUrl:i.svg_url};if(i.svg_url){const a=await fetch(i.svg_url,{headers:e}).then(l=>l.text());r.svgContent=a}return r};return await Promise.all(n.map(o))}function me(n){return{id:n.id,size:n.size,name:n.name,path:n.path,roomType:n.room_type,floorType:n.floor_type,roomLabel:{position:n.room_label.position,positionInImage:n.room_label.position_in_image},observerIndexs:n.observer_indexs}}function Ae(n){return{floorName:n.floor_name,floorIndex:n.floor_index,rooms:n.rooms.map(me),rules:n.rules}}function ge(n){return{index:n.index,floorIndex:n.floor_index,position:n.position,positionInImage:n.position_in_image}}function ve(n){return{rad:n.rad,position:n.position,positionInImage:n.position_in_image,northRad:n.north_rad,roomId:n.room_id,floorIndex:n.floor_index}}async function Le(n){const e=await ue(n.outlines),o=n.computed_data.bounding,t=n.computed_data.floor_datas.map(Ae),i=n.computed_data.entrance?ve(n.computed_data.entrance):null;return{outlines:e,entrance:i,bounding:o,floorDatas:t,observers:n.computed_data.observers.map(ge)}}function Ee(n,e,o){return n.map(i=>{const r=i.position,a=i.icon?i.icon:{url:re,width:45,height:48},l=ce(r,e),s=ae(r,o),f=fe(s,o);return{floorIndex:l,icon:a,id:i.id,position:s,positionInImage:f}})}const Qe="data:image/png;base64,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";function pe(n){b(n,"svelte-1cuuebb","img.svelte-1cuuebb{width:100%;height:100%}")}function he(n){let e,o;return{c(){e=C("img"),O(e.src,o=n[0])||g(e,"src",o),g(e,"alt","floorplan iamge"),g(e,"class","svelte-1cuuebb")},m(t,i){P(t,e,i)},p(t,[i]){i&1&&!O(e.src,o=t[0])&&g(e,"src",o)},i:p,o:p,d(t){t&&_(e)}}}function de(n,e,o){let{url:t}=e;return n.$$set=i=>{"url"in i&&o(0,t=i.url)},[t]}class Pe extends w{constructor(e){super();y(this,e,de,he,I,{url:0},pe)}}function _e(n){b(n,"svelte-1qqy56u",".floorplan-plugin__base-image.svelte-1qqy56u{width:100%;height:100%}")}function xe(n){let e,o,t,i;return{c(){e=C("div"),o=new N,t=S(),i=new N,o.a=t,i.a=null,g(e,"class","floorplan-plugin__base-image svelte-1qqy56u")},m(r,a){P(r,e,a),o.m(n[1],e),Q(e,t),i.m(n[0],e)},p(r,[a]){a&1&&i.p(r[0])},i:p,o:p,d(r){r&&_(e)}}}function we(n,e,o){let{content:t}=e;const i=`
    <style>
      svg [type='lineGroup'] path {
        fill: #ffffff;
        stroke: #ffffff;
      }
      svg [type='lineItemGroup'] g g g g {
        stroke: #ffffff;
      }
    </style>
  `;return n.$$set=r=>{"content"in r&&o(0,t=r.content)},[t,i]}class ye extends w{constructor(e){super();y(this,e,we,xe,I,{content:0},_e)}}function Ie(n){b(n,"svelte-126ja8e",".floorplan-plugin__base-image.svelte-126ja8e{position:absolute;z-index:10;width:100%;height:100%;pointer-events:none}")}function be(n){let e,o;return e=new Pe({props:{url:n[1].url}}),{c(){k(e.$$.fragment)},m(t,i){q(e,t,i),o=!0},p(t,i){const r={};i&2&&(r.url=t[1].url),e.$set(r)},i(t){o||(d(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){G(e,t)}}}function De(n){let e,o;return e=new ye({props:{content:n[0]}}),{c(){k(e.$$.fragment)},m(t,i){q(e,t,i),o=!0},p(t,i){const r={};i&1&&(r.content=t[0]),e.$set(r)},i(t){o||(d(e.$$.fragment,t),o=!0)},o(t){h(e.$$.fragment,t),o=!1},d(t){G(e,t)}}}function Ce(n){let e,o,t,i;const r=[De,be],a=[];function l(s,f){return s[0]?0:s[1]?1:-1}return~(o=l(n))&&(t=a[o]=r[o](n)),{c(){e=C("div"),t&&t.c(),g(e,"class","floorplan-plugin__base-image svelte-126ja8e")},m(s,f){P(s,e,f),~o&&a[o].m(e,null),i=!0},p(s,[f]){let A=o;o=l(s),o===A?~o&&a[o].p(s,f):(t&&(J(),h(a[A],1,1,()=>{a[A]=null}),z()),~o?(t=a[o],t?t.p(s,f):(t=a[o]=r[o](s),t.c()),d(t,1),t.m(e,null)):t=null)},i(s){i||(d(t),i=!0)},o(s){h(t),i=!1},d(s){s&&_(e),~o&&a[o].d()}}}function ke(n,e,o){let t,i,{floorIndex:r}=e,{floorplanData:a}=e;return n.$$set=l=>{"floorIndex"in l&&o(2,r=l.floorIndex),"floorplanData"in l&&o(3,a=l.floorplanData)},n.$$.update=()=>{n.$$.dirty&12&&o(1,t=a.outlines[r]),n.$$.dirty&12&&o(0,i=a.outlines?.[r]?.svgContent)},[i,t,r,a]}class Je extends w{constructor(e){super();y(this,e,ke,Ce,I,{floorIndex:2,floorplanData:3},Ie)}}function qe(n){b(n,"svelte-11takew","path.svelte-11takew{opacity:0}path.svelte-11takew:hover{opacity:0.1}")}function Ge(n){let e;return{c(){e=K("path"),g(e,"d",n[0]),g(e,"fill","#fff"),g(e,"class","svelte-11takew")},m(o,t){P(o,e,t)},p,i:p,o:p,d(o){o&&_(e)}}}function Me(n,e,o){let{pxmm:t}=e,{room:i}=e,{floorplanData:r}=e;const{bounding:a}=r,l=le(i.path,{needZ:!0,format:s=>se(s,t,a)});return n.$$set=s=>{"pxmm"in s&&o(1,t=s.pxmm),"room"in s&&o(2,i=s.room),"floorplanData"in s&&o(3,r=s.floorplanData)},[l,t,i,r]}class Re extends w{constructor(e){super();y(this,e,Me,Ge,I,{pxmm:1,room:2,floorplanData:3},qe)}}function He(n){b(n,"svelte-1aais5l",".floorplan-plugin__room-highlight.svelte-1aais5l{position:absolute;width:100%;height:100%;pointer-events:all}svg.svelte-1aais5l{width:100%;height:100%;overflow:visible}")}function L(n,e,o){const t=n.slice();return t[12]=e[o],t}function E(n,e){let o,t,i;const r=[{room:e[12],floorplanData:e[2],pxmm:e[0]}];let a={};for(let l=0;l<r.length;l+=1)a=oe(a,r[l]);return t=new Re({props:a}),{key:n,first:null,c(){o=Z(),k(t.$$.fragment),this.first=o},m(l,s){P(l,o,s),q(t,l,s),i=!0},p(l,s){e=l;const f=s&7?V(r,[{room:e[12],floorplanData:e[2],pxmm:e[0]}]):{};t.$set(f)},i(l){i||(d(t.$$.fragment,l),i=!0)},o(l){h(t.$$.fragment,l),i=!1},d(l){l&&_(o),G(t,l)}}}function Be(n){let e,o,t=[],i=new Map,r,a,l,s,f=n[2].floorDatas[n[1]].rooms;const A=c=>c[12].id;for(let c=0;c<f.length;c+=1){let u=L(n,f,c),v=A(u);i.set(v,t[c]=E(v,u))}return{c(){e=C("div"),o=K("svg");for(let c=0;c<t.length;c+=1)t[c].c();g(o,"class","svelte-1aais5l"),g(e,"class","floorplan-plugin__room-highlight svelte-1aais5l"),X(()=>n[10].call(e))},m(c,u){P(c,e,u),Q(e,o);for(let v=0;v<t.length;v+=1)t[v].m(o,null);n[9](e),r=$(e,n[10].bind(e)),a=!0,l||(s=ee(e,"click",n[6]),l=!0)},p(c,[u]){u&7&&(f=c[2].floorDatas[c[1]].rooms,J(),t=ne(t,u,A,1,c,f,i,o,te,E,null,L),z())},i(c){if(!a){for(let u=0;u<f.length;u+=1)d(t[u]);a=!0}},o(c){for(let u=0;u<t.length;u+=1)h(t[u]);a=!1},d(c){c&&_(e);for(let u=0;u<t.length;u+=1)t[u].d();n[9](null),r(),l=!1,s()}}}function Oe(n,e,o){let{five:t}=e,{pxmm:i}=e,{floorIndex:r}=e,{floorplanData:a}=e,{onRoomHeightClick:l}=e,s,f,A;const{observers:c}=a,u=function(m){if(l?.(m)===!1)return;const M=A.getBoundingClientRect(),Y=new x(m.clientX,m.clientY),j=new x(M.left,M.top),R=Y.clone().sub(j),H=new x(R.x/s,R.y/f),T=c.filter(D=>D.floorIndex===r).sort((D,B)=>{const W=new x(D.positionInImage.x,D.positionInImage.y),F=new x(B.positionInImage.x,B.positionInImage.y);return W.distanceTo(H)-F.distanceTo(H)})[0];t.moveToPano(T.index)};function v(m){ie[m?"unshift":"push"](()=>{A=m,o(5,A)})}function U(){s=this.clientWidth,f=this.clientHeight,o(3,s),o(4,f)}return n.$$set=m=>{"five"in m&&o(7,t=m.five),"pxmm"in m&&o(0,i=m.pxmm),"floorIndex"in m&&o(1,r=m.floorIndex),"floorplanData"in m&&o(2,a=m.floorplanData),"onRoomHeightClick"in m&&o(8,l=m.onRoomHeightClick)},[i,r,a,s,f,A,u,t,l,v,U]}class ze extends w{constructor(e){super();y(this,e,Oe,Be,I,{five:7,pxmm:0,floorIndex:1,floorplanData:2,onRoomHeightClick:8},He)}}export{Qe as C,Je as a,ze as b,Ee as c,se as d,Le as f,le as p};
